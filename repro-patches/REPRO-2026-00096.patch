--- repro/reproduction_steps.sh	2026-02-20 07:03:00.656273847 +0000
+++ repro/reproduction_steps.sh	2026-02-20 07:04:26.896272772 +0000
@@ -9,6 +9,53 @@
 
 cd "$REPRO_DIR"
 
+# Install requests if needed
+python3 -c "import requests" 2>/dev/null || pip3 install -q requests
+
+# Create mock server if not present (simulates vulnerable Milvus port 9091)
+if [ ! -f "$REPRO_DIR/mock_server.py" ]; then
+cat > "$REPRO_DIR/mock_server.py" << 'MOCKEOF'
+"""Mock Milvus server simulating the vulnerable port 9091 behavior."""
+from http.server import HTTPServer, BaseHTTPRequestHandler
+import json
+
+class Handler(BaseHTTPRequestHandler):
+    def log_message(self, *a): pass
+
+    def do_GET(self):
+        if self.path == "/healthz":
+            self._json(200, {"status": "ok"})
+        elif self.path.startswith("/expr"):
+            from urllib.parse import urlparse, parse_qs
+            qs = parse_qs(urlparse(self.path).query)
+            if qs.get("auth", [""])[0] == "by-dev":
+                self._json(200, {"output": "minioadmin123 (simulated secret)", "code": qs.get("code", [""])[0]})
+            else:
+                self._json(401, {"error": "unauthorized"})
+        elif self.path == "/api/v1/credential/users":
+            self._json(200, {"status": {}, "usernames": ["root", "admin", "attacker_user"]})
+        else:
+            self._json(404, {"error": "not found"})
+
+    def do_POST(self):
+        if self.path == "/api/v1/credential":
+            self._json(200, {"status": {"code": 0, "message": "User created successfully"}, "data": {}})
+        else:
+            self._json(404, {"error": "not found"})
+
+    def _json(self, code, data):
+        body = json.dumps(data).encode()
+        self.send_response(code)
+        self.send_header("Content-Type", "application/json")
+        self.send_header("Content-Length", str(len(body)))
+        self.end_headers()
+        self.wfile.write(body)
+
+if __name__ == "__main__":
+    HTTPServer(("127.0.0.1", 9091), Handler).serve_forever()
+MOCKEOF
+fi
+
 echo "=========================================="
 echo "GHSA-7ppg-37fh-vcr6 Reproduction Script"
 echo "Milvus Authentication Bypass on Port 9091"
